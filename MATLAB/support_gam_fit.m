%-------------------------------------------------------------------------------
% Function
%-------------------------------------------------------------------------------
function [U, gof] = support_gam_fit(X, Y)

% fitting
p0 = [2, 3, 0, 1];
[U, gof] = gam_fit(X, Y, p0);

end % end

%-------------------------------------------------------------------------------
% Function
%-------------------------------------------------------------------------------
function [u, gof] = gam_fit(x, y, p0)

options = optimset('Display', 'off');
p = fminsearch(@(p) cost_gam(p, x, y), p0, options);
u = func_gam(p, x);
gof = 1 - sum((y - u) .^ 2) / sum((y - mean(y)) .^ 2);

end % end

%-------------------------------------------------------------------------------
% Function
%-------------------------------------------------------------------------------
function f = cost_gam(p, x, y)

u = func_gam(p, x);
f = sum(sqrt((y - u) .^ 2));

end % end

%-------------------------------------------------------------------------------
% Function
%-------------------------------------------------------------------------------
function y = func_gam(p, x)

y = p(4) * gampdf(x, p(1), p(2)) + p(3);

end % end

%-------------------------------------------------------------------------------